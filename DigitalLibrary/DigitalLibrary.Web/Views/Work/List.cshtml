@{
    ViewBag.Title = "List";
    var currentYear = DateTime.Now.Year;
}

<div class="row-fluid">
    @using (Html.BeginForm("Search", "Work", FormMethod.Post))
    {
        <div>
            Search by Model
        </div>
        @(Html.Kendo()
            .AutoComplete()
            .Name("MatchSearch")
            .DataTextField("MatchResult")
            .MinLength(1)
            .DataSource(data =>
            {
                data.Read(read =>
                    {
                        read.Action("GetWorkData", "Work")
                            .Data("onAdditionalData");
                    })
                    .ServerFiltering(true);
            }))
    <br />
    <div>
        Search by Genre
    </div>
        @(Html.Kendo()
            .DropDownList()
            .Name("genresearch")
            .DataTextField("Genre")
            .DataValueField("Genre")
            .OptionLabel("All")
            .DataSource(data =>
            {
                data.Read(read => read.Action("GetWorkGenreData", "Work"));
                data.ServerFiltering(true);
            }))

    <br />
    <div>
        Search by Year
    </div>
    @(Html.Kendo()
        .NumericTextBox()
        .Name("pricesearch")
        .Min(1800)
        .Max(currentYear))
    <div>
        <input type="submit" value="Search" class="btn" />
    </div>
    }
    

</div>
<br />

@(Html.Kendo()
    .ListView<DigitalLibrary.Web.Models.WorkListViewModel>()
    .Name("work")
    .TagName("div")
    .ClientTemplateId("work-template")
    .Pageable()
    .DataSource(data =>
    {
        data.Read("GetWorks", "Work");
        data.ServerOperation(true);
        data.PageSize(4);
    }))

<script id="work-template" type="text/x-kendo-template">
    
    <div class="col-lg-4 list-page-list home-page-list">
        <a class="btn btn-info hoover-pop" href="/Work/Download/#: Id #">
            Download
        </a>
        <a class="btn btn-info hoover-pop" href="/Work/Details/#: Id #">
            <h3>#: Title #</h3>
            <img src="/${PictureLink}" />
        </a>
        <a class="btn" href="/Author/Details/#: AuthorId #">
            #: AuthorName #
        </a>
        #: Year #
        <div class="rating-container"><p class="rating-bar" style="width:#:LikesCount#%"></p></div>
        <div class="row"></div>
    </div>

</script>
<script>
    function onAdditionalData() {
        return {
            text: $('#MatchSearch').val()
        };
    }
</script>